---
title: Ark ELI5
layout: main
description: Explain ARK like I'm 5
---

<style>
  .ark svg {
    margin-bottom: 2rem;
  }
  .dark-theme .ark svg,
  .dark-theme .ark svg polygon {
    fill: white;
  }
  .dark-theme .ark svg line.part {
    stroke: white;
  }
  .ark .hidden {
    display: none;
    padding-top: 1rem;
  }
  .ark .tech {
    background-color: var(--lightgrey);
    margin: 0 -1rem 1rem -1rem;
    padding: 1rem;
  }
  .dark-theme .ark .tech {
    background-color: var(--darkgrey);
  }
  .ark a {
    cursor: pointer;
  }
  .ark h3 {
    margin: 2em 0 1em 0;
  }
  .ark ol li {
    margin-bottom: 1rem;
  }
</style>

<script>
  function toggleVisibility(selector) {
    const element = document.querySelector(selector)
    const display = element.style.display
    element.style.display = display === 'block' ? 'none' : 'block'
  }
</script>

<script src="https://google.github.io/typograms/typograms.js"></script>

<section class="ark">
  <div class="container">
    <h2 class="heading">
      <span class="gradient">Explain ARK like I'm 5</span>
    </h2>
    <h3>ELI5</h3>
    <ul>
      <li>
        Alice sends money to the bank and in return receives a check from the bank that she can redeem anytime anywhere
        (not only on this bank).
      </li>
      <li>
        If Alice wants to pay Bob using Ark, she can ask the bank to pay Bob, and in return she will endorse their check
        back to the bank.
      </li>
      <li>The bank can only redeem Alice's check if it shows proof of payment to Bob.</li>
      <li>Bob receives a check from the bank that he can redeem anytime anywhere.</li>
    </ul>
    <h3>Onboarding</h3>
    <p>
      The first step is for Alice to lift her coins. This is an atomic swap where she will give up a UTXO (+ fees) to
      receive a vUTXO from the ASP at the same time. The ASP makes a special transaction, called pool transaction (Pool
      Tx), where it mixes UTXOs from many users (among other things) and creates a shared UTXO as well as many off-chain
      vUTXOs for each of those users including one for Alice.
    </p>
    <p>In this example, Alice, Bob and Carol are "lifting" 1 BTC each to Ark:</p>
    <script type="text/typogram">
      {% include txt/ark/onboarding.txt %}
    </script>
    <div class="tech">
      <a onclick="toggleVisibility('#dd1')">Deep dive</a>
      <div class="hidden" id="dd1">
        <p>Every 5 seconds there's an onchain transaction:</p>
        <script type="text/typogram">
          {% include txt/ark/pool_tx0.txt %}
        </script>
        <p>
          A pool transaction is a coin-join transaction broadcasted to the main chain. The Ark Service Provider is
          responsible to create it and to manage the coin-join signing rounds.
        </p>
        <p>The output is a UTXO locked by 2 taproot leaves:</p>
        <ul>
          <li>a multisig 4 of 4, where 4 is the number of participants in the transaction.</li>
          <li>the other leaf allows the ASP to spend it alone after 4 weeks.</li>
        </ul>
        <p>
          In order to be trustless, before signing the pool tx Alice needs a way to unilaterally get their funds back.
          To achieve this, the ASP builds and signs a binary tree of transactions and share them with each participant.
          Each leaf on this tree represents a vUTXO.
        </p>
        <p>
          In the example below, Alice will receive <strong>tx1 => tx2 => tx4</strong> that she can broadcast anytime to
          receive their funds back:
        </p>
        <script type="text/typogram">
          {% include txt/ark/redeem_tx.txt %}
        </script>
        <p>Notes:</p>
        <ul>
          <li>
            Since <strong>tx1 => tx2 => tx4</strong> have no fees, Alice will need to add an extra tx to pay for all the
            fees (see <a href="https://bitcoinops.org/en/topics/cpfp/" target="_blank">CPFP</a>).
          </li>
          <li>
            The number of transactions on this branches will be equal to log2(n) + 1, where n = number of participants
          </li>
        </ul>
        <p>For clarity, vUTXO will be represented like this:</p>
        <script type="text/typogram">
          {% include txt/ark/pool_tx1.txt %}
        </script>
      </div>
    </div>
    <h3>Payment</h3>
    <p>
      Alice then instructs the ASP to take her vUTXO and pay Bob. She will only need to know Bob's address. This payment
      is also atomic and private. The ASP does not know which vUTXO belongs to which user and blindly mixes them to
      produce another anonymous vUTXO set. Ark's magic occurs in the fact that the post-mix vUTXOs can only be claimed
      by the intended recipients even though the ASP has no idea who owns them. Put another way, the ASP is simply
      coordinating blind coinjoin rounds. Bob does not have to be online to receive the funds, can claim them at any
      time, transfer them to others, or move them on-chain.
    </p>
    <p>Now let's imagine Alice wants to send Dave 1 BTC using Ark:</p>
    <script type="text/typogram">
      {% include txt/ark/payment.txt %}
    </script>
    <p>Alice forfeits its vUTXO to the ASP and in return Bob receives a vUTXO</p>
    <div class="tech">
      <a onclick="toggleVisibility('#dd2')">Deep dive</a>
      <div class="hidden" id="dd2">
        <ol>
          <li>Alice asks Dave for an address (address D)</li>
          <li>Alice informs ASP she wants to pay 1 BTC to address D</li>
          <li>ASP (with help of Dave) prepares new transaction (Pool Tx 2) and show it to Alice:</li>
          <script type="text/typogram">
            {% include txt/ark/pool_tx2.txt %}
          </script>
          <li>Alice looks at the locking script for this new UTXO and sees Daves's public key on it</li>
          <li>Alice understands that when Pool Tx 2 confirms, Dave will have 1 BTC on Ark</li>
          <li>Alice proceeds by sending her vUTXO to the server, on the condition that Pool Tx 2 is confirmed:</li>
          <script type="text/typogram">
            {% include txt/ark/diagram4.txt %}
          </script>
          <li>
            ASP cannot cheat, if he wants to receive from Alice he needs to send it to Dave, which means Alice is paying
            Dave atomically.
          </li>
        </ol>
        <p><strong>"only if Pool Tx 2 is confirmed"</strong></p>
        <p>
          This condition is not possible to implement today using Bitcoin script, but we can implement it using a trick:
        </p>
        <ul>
          <li>
            Pool Tx 1 will have additional outputs, called
            <strong>connectors</strong>
          </li>
          <li>This connectors have no financial value (dust limit)</li>
          <li>Connectors are singlesig spendable by the ASP</li>
          <li>Alice will use one of this connectors as input to the new transaction</li>
          <li>Alice will sign her vUTXO with SIGHASH_ALL to commit to all inputs</li>
          <li>The ASP will sign the connector input</li>
        </ul>
        <script type="text/typogram">
          {% include txt/ark/diagram5.txt %}
        </script>
        <p>This way, the Tx where Alice gives her vUTXO to the server is only valid if Pool Tx 2 is confirmed.</p>
      </div>
    </div>
    <p>To be continued...</p>
    <p>Sources:</p>
    <ul>
      <li>
        <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-August/021858.html"
          >https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-August/021858.html</a
        >
      </li>
      <li>
        <a href="https://www.youtube.com/watch?v=EocWax43QgQ">https://www.youtube.com/watch?v=EocWax43QgQ</a>
      </li>
      <li>
        <a href="https://bitguide.substack.com/p/ark-bitcoins-new-layer-2-protocol"
          >https://bitguide.substack.com/p/ark-bitcoins-new-layer-2-protocol</a
        >
      </li>
      <li>
        <a href="https://gist.github.com/RubenSomsen/a394beb1dea9e47e981216768e007454"
          >https://gist.github.com/RubenSomsen/a394beb1dea9e47e981216768e007454</a
        >
      </li>
      <li>
        <a href="https://roose.io/presentations/understanding-ark.pdf"
          >https://roose.io/presentations/understanding-ark.pdf</a
        >
      </li>
    </ul>
  </div>
</section>
