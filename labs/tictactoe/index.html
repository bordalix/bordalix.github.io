---
title: Tic Tac Toe
layout: main
description: Play Tic Tac Toe
---

<style>
  .board {
    display: grid;
    gap: 0.5rem;
    grid-template-columns: 1fr 1fr 1fr;
    margin-bottom: 1rem;
    width: 16rem;
    & p {
      border: 1px solid orange;
      margin: 0;
      padding: 2rem 2.5rem;
    }
  }
</style>

<div class="container" id="tictactoe">
  <h1>Play Tic Tac Toe</h1>
  <noscript>Needs javascript to run.</noscript>
  <p id="announcement" style="margin: 1rem 0 0.4rem 0">&nbsp;</p>
  <div id="boardContainer"></div>
  <button onclick="resetBoard()">Reset</button>
</div>

<template id="boardTemplate">
  <div class="board">
    <p id="c00" onclick="handleClick(this)">&nbsp;</p>
    <p id="c01" onclick="handleClick(this)">&nbsp;</p>
    <p id="c02" onclick="handleClick(this)">&nbsp;</p>
    <p id="c10" onclick="handleClick(this)">&nbsp;</p>
    <p id="c11" onclick="handleClick(this)">&nbsp;</p>
    <p id="c12" onclick="handleClick(this)">&nbsp;</p>
    <p id="c20" onclick="handleClick(this)">&nbsp;</p>
    <p id="c21" onclick="handleClick(this)">&nbsp;</p>
    <p id="c22" onclick="handleClick(this)">&nbsp;</p>
  </div>
</template>

<script>
  let turn = 0
  let gameEnded = false
  const symbols = ['x', 'o']
  const currentSymbol = () => symbols[turn % 2]

  const emptyBoard = [
    [undefined, undefined, undefined],
    [undefined, undefined, undefined],
    [undefined, undefined, undefined],
  ]

  let actualBoard = structuredClone(emptyBoard)

  const incrementTurn = () => turn++

  const resetBoard = () => {
    turn = 0
    gameEnded = false
    actualBoard = structuredClone(emptyBoard)
    document.querySelector('#announcement').innerHTML = '&nbsp;'
    updateBoard()
  }

  const getBoardContainer = () => {
    const container = document.querySelector('#boardContainer')
    container.innerHTML = ''
    return container
  }

  const updateBoard = () => {
    const container = getBoardContainer()
    const clone = boardTemplate.content.cloneNode(true)
    for (let row = 0; row < 3; row++) {
      for (let col = 0; col < 3; col++) {
        const val = actualBoard[row][col]
        if (val) clone.querySelector(`#c${row}${col}`).innerText = val
      }
    }
    container.append(clone)
  }

  const updateSquare = (id, symbol) => {
    const [row, col] = id.replace('c', '').split('')
    actualBoard[row][col] = symbol
  }

  const tooManySymbols = () => {
    const count = actualBoard.reduce(
      (prev, row) =>
        prev +
        row.reduce((p, c) => {
          return c === currentSymbol() ? p + 1 : p
        }, 0),
      0
    )
    return count > 3
  }

  const getRandomEmoji = () => {
    const emojis = ['ðŸŽ‰', 'ðŸ¥³', 'ðŸŽŠ', 'ðŸ¾', 'ðŸ•º', 'ðŸ’ƒ']
    const randomIndex = Math.floor(Math.random() * emojis.length)
    return emojis[randomIndex]
  }

  const getRandomSquare = (id) => {
    const squares = []
    for (let row = 0; row < 3; row++) {
      for (let col = 0; col < 3; col++) {
        const cellId = `c${row}${col}`
        if (actualBoard[row][col] === currentSymbol() && id !== cellId)
          squares.push(cellId)
      }
    }
    const randomIndex = Math.floor(Math.random() * squares.length)
    return squares[randomIndex]
  }

  const threeInARow = () => {
    // rows
    for (let row = 0; row < 3; row++) {
      if (
        actualBoard[row][0] &&
        actualBoard[row][0] === actualBoard[row][1] &&
        actualBoard[row][0] === actualBoard[row][2]
      )
        return actualBoard[row][0]
    }
    // cols
    for (let col = 0; col < 3; col++) {
      if (
        actualBoard[0][col] &&
        actualBoard[0][col] === actualBoard[1][col] &&
        actualBoard[0][col] === actualBoard[2][col]
      )
        return actualBoard[0][col]
    }
    // diagonal \
    if (
      actualBoard[0][0] &&
      actualBoard[0][0] === actualBoard[1][1] &&
      actualBoard[0][0] === actualBoard[2][2]
    )
      return actualBoard[0][0]
    // diagonal /
    if (
      actualBoard[0][2] &&
      actualBoard[0][2] === actualBoard[1][1] &&
      actualBoard[0][2] === actualBoard[2][0]
    )
      return actualBoard[0][2]
  }

  const declareVictory = () => {
    gameEnded = true
    document.querySelector(
      '#announcement'
    ).innerText = `${getRandomEmoji()} ${threeInARow().toUpperCase()} as won`
  }

  const handleClick = ({ id }) => {
    if (gameEnded) return
    updateSquare(id, currentSymbol())
    updateBoard()
    if (threeInARow()) return declareVictory()
    if (tooManySymbols()) {
      const randomSquareId = getRandomSquare(id)
      console.log('randomSquareId', randomSquareId)
      updateSquare(randomSquareId, undefined)
      updateBoard()
    }
    incrementTurn()
  }

  window.onload = () => {
    updateBoard()
  }
</script>