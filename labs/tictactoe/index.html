---
title: Tic Tac Toe
layout: main
description: Play Tic Tac Toe
---

<style>
  html {
    --square-size: 4rem;
    --gap-width: 0.5rem;
  }
  #boardContainer {
    --board-width: calc(calc(3 * var(--square-size)) + calc(2 * var(--gap-width)));
    width: var(--board-width);
    & p {
      text-align: center;
    }
  }
  #announcement {
    font-size: 1.2rem;
    margin: 1rem 0 0.4rem;
  }
  .board {
    display: grid;
    gap: var(--gap-width);
    grid-template-columns: 1fr 1fr 1fr;
    margin-bottom: 1rem;
    & p {
      background-color: var(--cream);
      border: 1px solid var(--orange);
      font-size: 3rem;
      height: var(--square-size);
      line-height: 1;
      margin: 0;
      width: var(--square-size);
    }
    & p.winner {
      background-color: var(--lime);
    }
  }
</style>

<div class="container" id="tictactoe">
  <h2>Play Tic Tac Toe</h2>
  <h3 class="lead" style="margin-bottom: 2rem">There can be only 3</h3>
  <noscript>Needs javascript to run.</noscript>
  <div id="boardContainer"></div>
</div>

<template id="boardTemplate">
  <p id="announcement">&nbsp;</p>
  <div class="board">
    <p id="c00" onclick="handleClick(this)">&nbsp;</p>
    <p id="c01" onclick="handleClick(this)">&nbsp;</p>
    <p id="c02" onclick="handleClick(this)">&nbsp;</p>
    <p id="c10" onclick="handleClick(this)">&nbsp;</p>
    <p id="c11" onclick="handleClick(this)">&nbsp;</p>
    <p id="c12" onclick="handleClick(this)">&nbsp;</p>
    <p id="c20" onclick="handleClick(this)">&nbsp;</p>
    <p id="c21" onclick="handleClick(this)">&nbsp;</p>
    <p id="c22" onclick="handleClick(this)">&nbsp;</p>
  </div>
  <p>
    <button class="btn" onclick="resetBoard()">Reset board</button>
  </p>
</template>

<script>
  let turn = 0
  let gameEnded = false
  const symbols = ['x', 'o']
  const currentSymbol = () => symbols[turn % 2]

  const emptyBoard = [
    [undefined, undefined, undefined],
    [undefined, undefined, undefined],
    [undefined, undefined, undefined],
  ]

  let actualBoard = structuredClone(emptyBoard)

  const incrementTurn = () => turn++

  const resetBoard = () => {
    turn = 0
    gameEnded = false
    actualBoard = structuredClone(emptyBoard)
    updateBoard()
  }

  const getBoardContainer = () => {
    const container = document.querySelector('#boardContainer')
    container.innerHTML = ''
    return container
  }

  const updateBoard = () => {
    const container = getBoardContainer()
    const clone = boardTemplate.content.cloneNode(true)
    for (let row = 0; row < 3; row++) {
      for (let col = 0; col < 3; col++) {
        const val = actualBoard[row][col]
        if (val) clone.querySelector(`#c${row}${col}`).innerText = val
      }
    }
    container.append(clone)
  }

  const updateSquare = (id, symbol) => {
    const [row, col] = id.replace('c', '').split('')
    actualBoard[row][col] = symbol
  }

  const tooManySymbols = () => {
    const count = actualBoard.reduce(
      (prev, row) =>
        prev +
        row.reduce((p, c) => {
          return c === currentSymbol() ? p + 1 : p
        }, 0),
      0
    )
    return count > 3
  }

  const getRandomEmoji = () => {
    const emojis = ['ðŸŽ‰', 'ðŸ¥³', 'ðŸŽŠ', 'ðŸ¾', 'ðŸ•º', 'ðŸ’ƒ']
    const randomIndex = Math.floor(Math.random() * emojis.length)
    return emojis[randomIndex]
  }

  const getRandomSquare = (id) => {
    const squares = []
    for (let row = 0; row < 3; row++) {
      for (let col = 0; col < 3; col++) {
        const cellId = `c${row}${col}`
        if (actualBoard[row][col] === currentSymbol() && id !== cellId)
          squares.push(cellId)
      }
    }
    const randomIndex = Math.floor(Math.random() * squares.length)
    return squares[randomIndex]
  }

  const markWinner = (squares) => {
    squares.forEach((x) =>
      document.querySelector(`#c${x.join('')}`).classList.add('winner')
    )
  }

  const threeInARow = () => {
    // rows
    for (let row = 0; row < 3; row++) {
      if (
        actualBoard[row][0] &&
        actualBoard[row][0] === actualBoard[row][1] &&
        actualBoard[row][0] === actualBoard[row][2]
      ) {
        markWinner([[row, 0], [row, 1], [row, 2]])
        return actualBoard[row][0]
      }
    }
    // cols
    for (let col = 0; col < 3; col++) {
      if (
        actualBoard[0][col] &&
        actualBoard[0][col] === actualBoard[1][col] &&
        actualBoard[0][col] === actualBoard[2][col]
      ) {
        markWinner([[0, col], [1, col], [2, col]])
        return actualBoard[0][col]
      }
    }
    // diagonal \
    if (
      actualBoard[0][0] &&
      actualBoard[0][0] === actualBoard[1][1] &&
      actualBoard[0][0] === actualBoard[2][2]
    ) {
      markWinner([[0, 0], [1, 1], [2, 2]])
      return actualBoard[0][0]
    }
    // diagonal /
    if (
      actualBoard[0][2] &&
      actualBoard[0][2] === actualBoard[1][1] &&
      actualBoard[0][2] === actualBoard[2][0]
    ){
      markWinner([[0, 2], [1, 1], [2, 0]])
      return actualBoard[0][2]
    }
  }

  const declareVictory = () => {
    gameEnded = true
    document.querySelector(
      '#announcement'
    ).innerText = `${getRandomEmoji()} ${threeInARow().toUpperCase()} as won ${getRandomEmoji()}`
  }

  const handleClick = ({ id }) => {
    if (gameEnded) return
    updateSquare(id, currentSymbol())
    updateBoard()
    if (threeInARow()) return declareVictory()
    if (tooManySymbols()) {
      const randomSquareId = getRandomSquare(id)
      console.log('randomSquareId', randomSquareId)
      updateSquare(randomSquareId, undefined)
      updateBoard()
    }
    incrementTurn()
  }

  window.onload = () => {
    updateBoard()
  }
</script>